version: 1.0.{build}-{branch}

environment:
  matrix:
    - RUBY_VERSION: "200"
    - RUBY_VERSION: "200-x64"

clone_folder: c:\projects\openstudio-server

services: mongodb

install:
  - set PATH=C:\Ruby%RUBY_VERSION%\bin;%PATH%
  - dir C:\Ruby23-x64\DevKit\
  - ruby C:\Ruby23-x64\DevKit\dk.rb init
  - cp C:\projects\openstudio-server\ci\appveyor\devkit-config.yml C:\Ruby23-x64\DevKit\config.yml
  - dir C:\Ruby23-x64\DevKit\
  - ruby C:\Ruby23-x64\DevKit\dk.rb review
  - ruby C:\Ruby23-x64\DevKit\dk.rb install
  - ruby c:\projects\openstudio-server\bin\openstudio_meta install_gems --with_test_develop --debug --verbose
  - curl -SLO https://openstudio-resources.s3.amazonaws.com/pat-dependencies/OpenStudio2-1.13.0.fb588cc683-windows.zip
  - mkdir ~/openstudio
  - 7z x OpenStudio2-1.13.0.fb588cc683-windows.zip -oC:\openstudio

build: off

before_test:
  - ruby -v
  - gem -v
  - bundle -v

test_script:
  - bundle exec rspec